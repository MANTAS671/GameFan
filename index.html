<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover, maximum-scale=1" />
<title>–ê —Ç—ã —Ç–æ—á–Ω–æ –Ω–µ –ê–ª–µ–∫—Å–µ–π?</title>
<meta name="theme-color" content="#2e7d32" />
<style>
  :root{
    --bg:#f5f5dc;
    --ink:#333;
    --card:rgba(255,255,255,.9);
    --accent:#4caf50;
    --accent-2:#388e3c;
    --muted:#5d4037;
    --soft:rgba(0,0,0,.08);
    --radius:18px;
    --tap:14px;
  }

  *{box-sizing:border-box}
  html,body{height:100%}
  body{
    margin:0;
    font:16px/1.5 system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,"Helvetica Neue",Arial;
    color:var(--ink);
    background:var(--bg) center/cover no-repeat fixed;
    /* –º–æ–±–∏–ª—å–Ω—ã–π —Ñ–∏–∫—Å 100vh */
    min-height:100dvh;
    -webkit-font-smoothing:antialiased;
    -moz-osx-font-smoothing:grayscale;
    -webkit-tap-highlight-color: transparent;
    touch-action:manipulation;
    background-image:url('https://sfile.chatglm.cn/images-ppt/2db5e47dcc2a.jpg');
    background-attachment:scroll; /* iOS —Ñ–∏–∫—Å */
    padding:12px env(safe-area-inset-top) 12px env(safe-area-inset-right);
    padding-left: calc(12px + env(safe-area-inset-left));
    padding-bottom: calc(12px + env(safe-area-inset-bottom));
    display:grid;
    place-items:center;
  }

  .container{
    width:100%;
    max-width:680px;
    background:var(--card);
    border-radius:var(--radius);
    box-shadow:0 10px 30px rgba(0,0,0,.18);
    padding:16px;
    overflow:hidden;
    position:relative;
    backdrop-filter:saturate(1.2) blur(4px);
  }

  .blob, .blob2{
    content:"";
    position:absolute; inset:auto;
    width:220px;height:220px;border-radius:50%;
    background:rgba(76,175,80,.18);
    right:-60px; top:-60px; z-index:0; filter:blur(.3px)
  }
  .blob2{background:rgba(139,69,19,.12); left:-80px; bottom:-80px; right:auto; top:auto}

  .screen{position:relative; z-index:1; animation:fadeIn .35s ease both}
  @keyframes fadeIn{from{opacity:0;transform:translateY(8px)} to{opacity:1;transform:translateY(0)}}

  h1{
    margin:4px 8px 8px;
    text-align:center;
    color:#2e7d32;
    font-weight:800;
    font-size:clamp(22px,5.8vw,34px);
    letter-spacing:.3px;
    text-shadow:0 1px 0 rgba(0,0,0,.08);
    animation:bob 2.5s ease-in-out infinite;
  }
  @media (prefers-reduced-motion: reduce){ h1{animation:none} }
  @keyframes bob{0%,100%{transform:translateY(0)} 50%{transform:translateY(-6px)}}

  .description,.question,.result-title,.result-description,.quote{
    background:rgba(255,255,255,.72);
    border-radius:12px;
    padding:12px;
  }
  .description{ text-align:center; margin:8px auto 12px; font-size:clamp(14px,3.8vw,18px) }

  .btn{
    display:block; width:min(520px,100%);
    margin:10px auto; padding:14px 16px;
    font-weight:700; font-size:17px; text-align:center;
    border:0; border-radius:14px; color:#fff; background:var(--accent);
    box-shadow:0 6px 14px rgba(76,175,80,.4);
    cursor:pointer; transition:transform .08s ease, filter .2s ease, background .2s ease;
  }
  .btn:active{ transform:translateY(1px) scale(.99) }
  .btn.secondary{ background:#2e7d32 }
  .btn:disabled{ opacity:.5; pointer-events:none }

  .progress{width:100%; height:14px; background:rgba(0,0,0,.06); border-radius:10px; overflow:hidden; margin:6px 0 10px}
  .bar{height:100%; width:0%; background:var(--accent); transition:width .25s ease}

  .counter{ text-align:center; font-size:14px; color:var(--muted); margin-bottom:6px }

  .computer{
    width:92px; height:92px; margin:6px auto 10px;
    background:center/cover no-repeat; border-radius:14px;
    box-shadow:0 4px 12px var(--soft); animation:pulse 2s ease-in-out infinite;
  }
  @media (prefers-reduced-motion: reduce){ .computer{animation:none} }
  @keyframes pulse{0%{transform:scale(1)}50%{transform:scale(1.04)}100%{transform:scale(1)}}

  .question{ font-size:clamp(16px,4.3vw,20px); color:var(--muted); margin-bottom:10px }

  .answers{ display:grid; gap:10px; margin-bottom:12px }
  .answer{
    display:flex; gap:10px; align-items:center;
    background:rgba(232,245,233,.9); border-radius:12px; padding:10px;
    box-shadow:0 1px 4px rgba(0,0,0,.08);
    transition:transform .06s ease, background .2s ease, box-shadow .2s ease;
  }
  .answer:active{ transform:scale(.99) }
  .answer:hover{ background:rgba(200,230,201,.92) }
  .answer.selected{ background:rgba(165,214,167,.95); box-shadow:0 6px 14px rgba(0,0,0,.16) }
  .answer.disabled{ opacity:.6; pointer-events:none }
  .answer img{
    width:54px; height:54px; border-radius:10px; object-fit:cover; flex:0 0 54px; background:#ddd
  }
  .answer label{ display:block; font-size:clamp(14px,3.8vw,16px); cursor:pointer }
  .answer input{ accent-color:var(--accent); transform:scale(1.1); margin-right:2px }

  .quote{ font-style:italic; color:var(--muted); text-align:center; font-size:14px }

  .result-title{
    text-align:center; color:#2e7d32; font-weight:800; font-size:clamp(20px,5vw,26px);
    margin:8px 0 6px
  }
  .result-description{ text-align:center; font-size:clamp(14px,3.8vw,17px) }

  .frog{
    display:none; width:110px; height:110px; margin:12px auto 6px;
    background:url('https://sfile.chatglm.cn/images-ppt/9b652a81470b.jpg') center/cover no-repeat;
    border-radius:50%;
    animation:bob 1.6s ease-in-out infinite;
  }

  /* –ü–æ–ø–∞–ø */
  .overlay{
    position:fixed; inset:0; background:rgba(0,0,0,.5); display:none; z-index:50;
    backdrop-filter:blur(2px);
  }
  .popup{
    position:fixed; inset:auto; left:50%; top:50%; transform:translate(-50%,-50%) scale(.9);
    width:min(520px,92%); background:var(--card); border:2px solid var(--accent);
    border-radius:20px; padding:16px; text-align:center; display:none; z-index:60;
    box-shadow:0 18px 40px rgba(0,0,0,.32); animation:pop .22s ease forwards;
  }
  @keyframes pop{from{opacity:0;transform:translate(-50%,-46%) scale(.9)} to{opacity:1;transform:translate(-50%,-50%) scale(1)}}
  .popup img{ width:110px; height:110px; border-radius:50%; object-fit:cover; border:3px solid var(--accent); margin-bottom:10px }
  .popup p{ margin:0 0 10px; color:var(--muted); font-weight:700 }
  .popup .btn{ width:100% }

  /* –§–æ–∫—É—Å –∏ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å */
  :focus-visible{ outline:3px solid #80e27e; outline-offset:2px; border-radius:10px }

  /* –ú–æ–±–∏–ª–∫–∏ */
  @media (max-width:480px){
    .container{ padding:14px }
    .answer img{ width:50px; height:50px }
    .btn{ font-size:16px; padding:13px }
  }
</style>
</head>
<body>
  <div class="container" role="application" aria-live="polite">
    <i class="blob" aria-hidden="true"></i><i class="blob2" aria-hidden="true"></i>

    <!-- –°—Ç–∞—Ä—Ç -->
    <section class="screen" id="start">
      <h1>–ê —Ç—ã —Ç–æ—á–Ω–æ –Ω–µ –ê–ª–µ–∫—Å–µ–π?</h1>
      <p class="description">–ü—Ä–æ–π–¥–∏ —Ç–µ—Å—Ç –∏ —É–∑–Ω–∞–π, –Ω–∞—Å–∫–æ–ª—å–∫–æ —Å–∏–ª—å–Ω–æ —Ç—ã –∑–∞–≤–∏–¥—É–µ—à—å —á—É–∂–æ–º—É –∞–ø–≥—Ä–µ–π–¥—É. –û—Å—Ç–æ—Ä–æ–∂–Ω–æ: –≤–æ–∑–º–æ–∂–Ω—ã ¬´–∫–æ–ª–±–∞—Å–Ω—ã–µ –∫–æ–Ω—Ñ–ª–∏–∫—Ç—ã¬ª –∏ —Ñ–∏–ª–æ—Å–æ—Ñ–∏—è –≤ —Ç—É–∞–ª–µ—Ç–µ.</p>
      <button class="btn" id="startBtn" aria-label="–ù–∞—á–∞—Ç—å —Ç–µ—Å—Ç">–ù–∞—á–∞—Ç—å —Ç–µ—Å—Ç</button>
    </section>

    <!-- –í–∏–∫—Ç–æ—Ä–∏–Ω–∞ -->
    <section class="screen" id="quiz" hidden>
      <div class="progress" aria-hidden="true"><div class="bar" id="bar"></div></div>
      <div class="counter" id="counter"></div>
      <div class="computer" id="pc"></div>
      <div class="question" id="question" role="heading" aria-level="2"></div>
      <div class="answers" id="answers" role="radiogroup" aria-label="–í–∞—Ä–∏–∞–Ω—Ç—ã –æ—Ç–≤–µ—Ç–∞"></div>
      <p class="quote" id="quote"></p>
      <button class="btn secondary" id="nextBtn" disabled>–î–∞–ª–µ–µ</button>
    </section>

    <!-- –†–µ–∑—É–ª—å—Ç–∞—Ç—ã -->
    <section class="screen" id="result" hidden>
      <h2 class="result-title" id="resTitle"></h2>
      <p class="result-description" id="resDesc"></p>
      <div class="frog" id="frog"></div>
      <button class="btn" id="restartBtn">–ü—Ä–æ–π—Ç–∏ –∑–∞–Ω–æ–≤–æ</button>
    </section>
  </div>

  <!-- –ü–æ–ø–∞–ø –ê–ª–µ–∫—Å–µ—è -->
  <div class="overlay" id="overlay"></div>
  <div class="popup" id="popup" role="dialog" aria-modal="true" aria-labelledby="pTitle">
    <img src="https://sfile.chatglm.cn/images-ppt/3b5aac98c5b3.jpg" alt="–ê–ª–µ–∫—Å–µ–π" />
    <p id="pTitle"></p>
    <button class="btn" id="closePopup">–ü–æ–Ω—è—Ç–Ω–æ</button>
  </div>

<script>
/* ==== –î–ê–ù–ù–´–ï ==== */
const questions = [
  { question:"–¢—ã –∫—É–ø–∏–ª SSD –Ω–∞ 2 –¢–ë. –ß—Ç–æ —Å–∫–∞–∂–µ—à—å?",
    answers:[
      {text:"–° –∑–∞–¥–µ–ª–æ–º –Ω–∞ –±—É–¥—É—â–µ–µ",points:2,image:"https://sfile.chatglm.cn/images-ppt/72d26cd3c9a2.jpg"},
      {text:"–í –∫—Ä–µ–¥–∏—Ç, –∫–∞–∫ –Ω–æ—Ä–º–∞–ª—å–Ω—ã–µ –ª—é–¥–∏",points:1,image:"https://sfile.chatglm.cn/images-ppt/5842861121bb.jpg"},
      {text:"–®–æ —Ü–µ —Ç–∞–∫–µ?",points:0,image:"https://sfile.chatglm.cn/images-ppt/e459fb381b08.jpg"},
      {text:"–ü–æ—Å—Ç–∞–≤–ª—é, –µ—Å–ª–∏ –º–µ—Å—Ç–æ –Ω–∞–π–¥—É",points:1,image:"https://sfile.chatglm.cn/images-ppt/b7e9a44144e4.jpg"},
      {text:"–≠—Ç–æ –Ω–µ —Ç–æ, —á—Ç–æ —è –∂–¥–∞–ª –æ—Ç S.T.A.L.K.E.R. 2",points:1,image:"https://sfile.chatglm.cn/images-ppt/cfc3e245b2d7.jpg"}
    ],
    image:"https://sfile.chatglm.cn/images-ppt/72d26cd3c9a2.jpg",
    quote:"–õ—É—á—à–∏–π –∞–ø–≥—Ä–µ–π–¥ ‚Äî —ç—Ç–æ —Ç–æ—Ç, –∫–æ—Ç–æ—Ä—ã–π –ø–æ—Ç–æ–º –Ω–µ —Å—Ç—ã–¥–Ω–æ –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å."
  },
  { question:"–ö–∞–∫ —Ç—ã —Ä–µ–∞–≥–∏—Ä—É–µ—à—å, –µ—Å–ª–∏ –¥—Ä—É–≥ –∫—É–ø–∏–ª —Å–µ–±–µ –∫–æ–ª–±–∞—Å—É –∏ –Ω–µ –ø–æ–¥–µ–ª–∏–ª—Å—è?",
    answers:[
      {text:"–°–º–æ—Ç—Ä—é —Å –æ—Å—É–∂–¥–µ–Ω–∏–µ–º",points:1,image:"https://sfile.chatglm.cn/images-ppt/590bcaccd076.jpg"},
      {text:"–°—ä–µ–¥–∞—é –µ–≥–æ –Ω–æ—Å–∫–∏",points:0,image:"https://sfile.chatglm.cn/images-ppt/77eddcd4e76d.jpg"},
      {text:"–ì–æ–≤–æ—Ä—é: ¬´–ù–∞—Ö—É–π —Å –ø–ª—è–∂–∞¬ª",points:2,image:"https://sfile.chatglm.cn/images-ppt/baf2a18ee76a.jpg"},
      {text:"–ó–∞–≤–∏–¥—É—é –º–æ–ª—á–∞, –Ω–æ –Ω–æ—á—å—é –ø–∏—à—É –ø–∞—Å—Å–∏–≤–Ω–æ-–∞–≥—Ä–µ—Å—Å–∏–≤–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è",points:1,image:"https://sfile.chatglm.cn/images-ppt/4727ee8ef79d.jpeg"},
      {text:"–ò–¥—É –≤ —Ç—É–∞–ª–µ—Ç –Ω–∞ 2 —á–∞—Å–∞ –æ–±–¥—É–º—ã–≤–∞—Ç—å –∂–∏–∑–Ω—å",points:2,image:"https://sfile.chatglm.cn/images-ppt/e573713e143a.jpg"}
    ],
    image:"https://sfile.chatglm.cn/images-ppt/1fe0411bb968.jpg",
    quote:"–ö–æ–ª–±–∞—Å–∞ –¥–µ–ª–∏—Ç—Å—è, –∫–∞—Ä–º–∞ ‚Äî –Ω–µ—Ç."
  },
  /* ‚Ä¶ –≤—Å–µ –æ—Å—Ç–∞–ª—å–Ω—ã–µ –≤–æ–ø—Ä–æ—Å—ã –∏–∑ —Ç–≤–æ–µ–≥–æ —Å–ø–∏—Å–∫–∞ –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π ‚Ä¶ */
  { question:"–ö–∞–∫ —Ç—ã –æ—Ç–Ω–æ—Å–∏—à—å—Å—è –∫ –∏–≥—Ä–æ–≤—ã–º –∫—Ä–µ—Å–ª–∞–º?",
    answers:[
      {text:"–ù—É–∂–Ω–æ, –¥–∞–∂–µ –µ—Å–ª–∏ –ø—Ä–æ—Ü —Å—Ç–∞—Ä—ã–π",points:2,image:"https://sfile.chatglm.cn/images-ppt/d6ba94ccd270.jpg"},
      {text:"–ë–µ—Å–ø–æ–ª–µ–∑–Ω–∞—è —Ç—Ä–∞—Ç–∞ –¥–µ–Ω–µ–≥",points:0,image:"https://sfile.chatglm.cn/images-ppt/e459fb381b08.jpg"},
      {text:"–ö—É–ø–ª—é, –∫–æ–≥–¥–∞ –≤–æ–∑—å–º—É –≤ –∫—Ä–µ–¥–∏—Ç",points:1,image:"https://sfile.chatglm.cn/images-ppt/5842861121bb.jpg"},
      {text:"–õ—É—á—à–µ –∫—É–ø–∏—Ç—å –Ω–æ–≤—ã–π –ø—Ä–æ—Ü",points:1,image:"https://sfile.chatglm.cn/images-ppt/94c6e701f06d.png"},
      {text:"–ó–∞–≤–∏–¥—É—é —Ç–µ–º, —É –∫–æ–≥–æ –µ—Å—Ç—å",points:2,image:"https://sfile.chatglm.cn/images-ppt/dc68f2522b8a.jpg"}
    ],
    image:"https://sfile.chatglm.cn/images-ppt/d6ba94ccd270.jpg",
    quote:"–¢—Ä–æ–Ω –≥–µ–π–º–µ—Ä–∞ ‚Äî —ç—Ç–æ –Ω–µ —Å—Ç—É–ª, —ç—Ç–æ –æ–±—Ä–∞–∑ –∂–∏–∑–Ω–∏."
  }
];

// –†–µ–∑—É–ª—å—Ç–∞—Ç—ã
const results = [
  {minScore:0,maxScore:15,title:"üßò‚Äç‚ôÇÔ∏è –¢—ã ‚Äî –Ω–æ—Ä–º–∞–ª—å–Ω—ã–π —á–µ–ª–æ–≤–µ–∫",description:"–£ —Ç–µ–±—è –≤—Å—ë –≤ –ø–æ—Ä—è–¥–∫–µ: –∏ –Ω–æ—Å–∫–∏, –∏ —á—É–≤—Å—Ç–≤–∞, –∏ –ü–ö.<br>–ê–ª–µ–∫—Å–µ–π –±—ã —Ç–µ–±–µ –∑–∞–≤–∏–¥–æ–≤–∞–ª, –Ω–æ —Å–∫–∞–∑–∞–ª –±—ã: ¬´—Ç–∞ —Ö–∞–π‚Ä¶¬ª"},
  {minScore:16,maxScore:25,title:"üíæ –¢—ã ‚Äî –Ω–∞—á–∏–Ω–∞—é—â–∏–π –ê–ª–µ–∫—Å–µ–π",description:"–ù–∞—á–∞–ª–æ –ø—É—Ç–∏ –∞–ø–≥—Ä–µ–π–¥–∞. –ó–∞–≤–∏–¥—É–µ—à—å –∂–µ–ª–µ–∑—É, –Ω–æ –¥–µ—Ä–∂–∏—à—å—Å—è. –ü–æ—Ç–µ–Ω—Ü–∏–∞–ª –µ—Å—Ç—å!"},
  {minScore:26,maxScore:35,title:"üîß –¢—ã ‚Äî –ø–æ–ª—É–ê–ª–µ–∫—Å–µ–π",description:"–ë–∞–ª–∞–Ω—Å–∏—Ä—É–µ—à—å –º–µ–∂–¥—É –∑–¥—Ä–∞–≤—ã–º —Å–º—ã—Å–ª–æ–º –∏ –ø—Ä–æ–∫–ª—è—Ç–∏–µ–º –∞–ø–≥—Ä–µ–π–¥–∞. ¬´–ü–æ—á—Ç–∏ –±—Ä–∞—Ç!¬ª"},
  {minScore:36,maxScore:45,title:"üíª –¢—ã ‚Äî –ø–æ—á—Ç–∏ –ê–ª–µ–∫—Å–µ–π",description:"–ù–∞ –ø–æ—Ä–æ–≥–µ –≥–µ–Ω–∏–∞–ª—å–Ω–æ—Å—Ç–∏ –∞–ø–≥—Ä–µ–π–¥–∞. –ò–Ω–æ–≥–¥–∞ –¥–∞–∂–µ —Å–¥–µ—Ä–∂–∏–≤–∞–µ—à—å—Å—è."},
  {minScore:46,maxScore:60,title:"üß¶ –¢—ã ‚Äî 100% –ê–ª–µ–∫—Å–µ–π",description:"–ñ–∏–≤—ë—à—å –∞–ø–≥—Ä–µ–π–¥–∞–º–∏ –∏ —Å—Ç—Ä–∞–¥–∞–Ω–∏–µ–º. –ü–ª–∞—á–µ—à—å ‚Äî –Ω–æ –≤ —Ç—É–∞–ª–µ—Ç–µ –∏ –±–µ–∑ —Å–≤–∏–¥–µ—Ç–µ–ª–µ–π. –°–µ–ª—å—Å–∫–∏–π –∫–∏–±–µ—Ä–ø–∞–Ω–∫."}
];

// –û—Å—Ç—Ä–æ, –Ω–æ –±–µ–∑ –∑–∞–ø—Ä–µ—â—ë–Ω–Ω—ã—Ö —Å–ª–æ–≤
const alekseyComments = [
  "–¢–∞–∫–æ–π –æ—Ç–≤–µ—Ç ‚Äî –º–∏–Ω—É—Å –∫–∞—Ä–º–∞ –∏ –ø–ª—é—Å –∫—Ä–µ–¥–∏—Ç–Ω—ã–π –ª–∏–º–∏—Ç.",
  "–ú–æ–π —Å—Ç–∞—Ä—ã–π –ø—Ä–æ—Ü –∏ —Ç–æ —É–º–Ω–µ–µ. –ü–æ–¥–Ω–∞–∂–º–∏.",
  "–° —Ç–∞–∫–∏–º —Ç–µ–º–ø–æ–º —Ç—ã –ø–µ—Ä–µ–π–¥—ë—à—å –Ω–∞ HDD –Ω–µ –ø–æ —Å–≤–æ–µ–π –≤–æ–ª–µ.",
  "–î–≤–∞ —á–∞—Å–∞ –≤ —Ç—É–∞–ª–µ—Ç–µ ‚Äî –∏ –≤—Å—ë —Ä–∞–≤–Ω–æ –ª—É—á—à–µ, —á–µ–º —ç—Ç–æ—Ç –≤–∞—Ä–∏–∞–Ω—Ç.",
  "–ù–∞—Ö—É–π —Å –ø–ª—è–∂–∞ ‚Äî –Ω–æ —Å–Ω–∞—á–∞–ª–∞ –ø–µ—Ä–µ—á–∏—Ç–∞–π –≤–æ–ø—Ä–æ—Å.",
  "–ï—Å–ª–∏ –±—ã –∑–∞–≤–∏—Å—Ç—å –±—ã–ª–∞ –≤–∞–ª—é—Ç–æ–π, —Ç—ã –±—ã–ª –±—ã –æ–ª–∏–≥–∞—Ä—Ö.",
  "–≠—Ç–æ—Ç –æ—Ç–≤–µ—Ç –∫–∞–∫ RGB –±–µ–∑ –±–ª–æ–∫–∞ –ø–∏—Ç–∞–Ω–∏—è ‚Äî –±–ª–µ—Å—Ç–∏—Ç, –Ω–æ –±–µ—Å–ø–æ–ª–µ–∑–Ω–æ.",
  "–Ø –±—ã –ª—É—á—à–µ –Ω–æ—Å–∫–∏ –∑–∞—à—Ç–æ–ø–∞–ª, —á–µ–º —Ç–∞–∫ –æ—Ç–≤–µ—á–∞–ª.",
  "S.T.A.L.K.E.R. –µ—â—ë –Ω–µ –≤—ã—à–µ–ª, –∞ —Ç–≤–æ–π –æ—Ç–≤–µ—Ç —É–∂–µ —É—Å—Ç–∞—Ä–µ–ª.",
  "–í—ã–±–æ—Ä —Å–ª–∞–±—ã–π. –î–∞–≤–∞–π –±–µ–∑ ¬´—Ç–∞ —Ö–∞–π‚Ä¶¬ª, —Å–æ–±–µ—Ä–∏—Å—å."
];

/* ==== –°–û–°–¢–û–Ø–ù–ò–ï ==== */
let i = 0;
let score = 0;
let lastPick = null;
let streakSame = 0;
let locked = false;

/* ==== –≠–õ–ï–ú–ï–ù–¢–´ ==== */
const $ = sel => document.querySelector(sel);
const start = $('#start');
const quiz  = $('#quiz');
const result= $('#result');
const bar   = $('#bar');
const counter = $('#counter');
const pc    = $('#pc');
const qEl   = $('#question');
const answersWrap = $('#answers');
const quote = $('#quote');
const startBtn = $('#startBtn');
const nextBtn  = $('#nextBtn');
const restartBtn = $('#restartBtn');

const overlay = $('#overlay');
const popup   = $('#popup');
const pTitle  = $('#pTitle');
const closePopup = $('#closePopup');
const frog = $('#frog');
const resTitle = $('#resTitle');
const resDesc  = $('#resDesc');

/* ==== –í–°–ü–û–ú–û–ì–ê–¢–ï–õ–¨–ù–û–ï ==== */
function vibro(ms=12){ if (window.navigator?.vibrate) navigator.vibrate(ms) }
function clamp(n,min,max){return Math.max(min,Math.min(n,max))}
function show(el){ el.hidden=false }
function hide(el){ el.hidden=true }

/* ==== –õ–û–ì–ò–ö–ê ==== */
startBtn.addEventListener('click', () => {
  score=0; i=0; lastPick=null; streakSame=0;
  hide(start); show(quiz);
  renderQuestion();
});

nextBtn.addEventListener('click', () => {
  if (locked) return;
  i++;
  if (i<questions.length){ renderQuestion() } else { showResult() }
});

restartBtn?.addEventListener('click', () => {
  hide(result); show(start);
  frog.style.display='none';
  window.scrollTo({top:0,behavior:'smooth'});
});

/* –ü–æ–ø–∞–ø */
function showPopup(text){
  pTitle.textContent = text;
  overlay.style.display='block';
  popup.style.display='block';
  nextBtn.disabled=false;
}
function hidePopup(){
  overlay.style.display='none';
  popup.style.display='none';
}
overlay.addEventListener('click', hidePopup);
closePopup.addEventListener('click', hidePopup);

/* –†–ï–ù–î–ï–† –í–û–ü–†–û–°–ê */
function renderQuestion(){
  locked=false; nextBtn.disabled=true;
  const total = questions.length;
  const q = questions[i];

  // –ø—Ä–æ–≥—Ä–µ—Å—Å
  const progress = ((i+1)/total)*100;
  bar.style.width = progress.toFixed(1)+'%';
  counter.textContent = `–í–æ–ø—Ä–æ—Å ${i+1} –∏–∑ ${total}`;

  // –∫–∞—Ä—Ç–∏–Ω–∫–∞, —Ç–µ–∫—Å—Ç
  pc.style.backgroundImage = `url("${q.image}")`;
  qEl.textContent = q.question;
  quote.textContent = `"${q.quote}"`;

  // –æ—Ç–≤–µ—Ç—ã
  answersWrap.innerHTML = '';
  q.answers.forEach((ans,idx)=>{
    const row = document.createElement('div');
    row.className = 'answer';
    row.innerHTML = `
      <img src="${ans.image}" alt="" loading="lazy" decoding="async">
      <div style="display:flex;align-items:center;gap:8px">
        <input type="radio" id="a${i}_${idx}" name="q${i}" value="${idx}">
        <label for="a${i}_${idx}">${ans.text}</label>
      </div>
    `;
    row.addEventListener('click',()=>{
      if (locked) return;
      vibro(8);
      selectAnswer(idx,row,ans.points);
    }, {passive:true});
    answersWrap.appendChild(row);
  });
}

/* –í–´–ë–û–† –û–¢–í–ï–¢–ê */
function selectAnswer(idx, row, points){
  locked=true;
  // –≤–∏–∑—É–∞–ª—å–Ω–æ
  [...answersWrap.children].forEach((el,k)=>{
    if (k===idx) el.classList.add('selected'); else el.classList.add('disabled');
  });

  // –ø–∞—Å—Ö–∞–ª–∫–∞ —Å –∂–∞–±–æ–π
  if (lastPick === idx){ streakSame++; if (streakSame>=2) frog.style.display='block' }
  else { streakSame=0; frog.style.display='none' }
  lastPick = idx;

  score += points;

  // —Ä–∞–Ω–¥–æ–º–Ω—ã–π ¬´–∫–æ–º–º–µ–Ω—Ç –ê–ª–µ–∫—Å–µ—è¬ª
  const comment = alekseyComments[Math.floor(Math.random()*alekseyComments.length)];
  setTimeout(()=>{ showPopup(comment) }, 140);
}

/* –†–ï–ó–£–õ–¨–¢–ê–¢ */
function showResult(){
  hide(quiz); show(result);
  const r = results.find(r=> score>=r.minScore && score<=r.maxScore) || results[0];
  resTitle.innerHTML = r.title;
  resDesc.innerHTML  = r.description;
  window.scrollTo({top:0,behavior:'smooth'});
}

/* –î–û–ü. UX: –∑–∞–ø—Ä–µ—Ç –¥–∞–±–ª-—Ç–∞–ø –∑—É–º–∞ –Ω–∞ iOS */
let lastTouch=0;
document.addEventListener('touchend',e=>{
  const now=Date.now(); if(now-lastTouch<=300){ e.preventDefault() }
  lastTouch=now;
},{passive:false});

/* Respect reduced motion: —É–±–∏—Ä–∞–µ–º –∞–≤—Ç–æ–ø—É–ª—å—Å –∫–∞—Ä—Ç–∏–Ω–∫–∏ */
if (window.matchMedia('(prefers-reduced-motion: reduce)').matches){
  document.documentElement.classList.add('reduce-motion');
}

/* –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –∫–∞—Ä—Ç–∏–Ω–æ–∫: –µ—Å–ª–∏ —Å—Å—ã–ª–∫–∞ —É–ø–∞–ª–∞ ‚Äî —Å–µ—Ä—ã–π —Ñ–æ–Ω –æ—Å—Ç–∞—ë—Ç—Å—è */
</script>
</body>
</html>
