<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Blackjack на Русском</title>
    <style>
        /* Стили для игры */
        :root {
            --bg-color: #1a3a1a;
            --table-color: #0d5c0d;
            --card-bg: #ffffff;
            --text-color: #ffffff;
            --button-bg: #d4af37;
            --button-hover-bg: #b89a2a;
            --font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            font-family: var(--font-family);
            background-color: var(--bg-color);
            color: var(--text-color);
            margin: 0;
            padding: 1rem;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            text-align: center;
        }

        .game-container {
            background-color: var(--table-color);
            border-radius: 15px;
            padding: 1.5rem;
            box-shadow: 0 10px 20px rgba(0,0,0,0.3);
            width: 100%;
            max-width: 800px;
            box-sizing: border-box;
        }

        h1 {
            margin-top: 0;
            color: var(--button-bg);
        }

        .hand {
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 120px;
            margin: 1rem 0;
            flex-wrap: wrap;
        }

        .card {
            background-color: var(--card-bg);
            color: #000;
            width: 70px;
            height: 100px;
            border-radius: 8px;
            border: 1px solid #ccc;
            margin: 5px;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 1.8rem;
            font-weight: bold;
            position: relative;
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
        }
        
        .card.hidden {
            background-color: #b30000;
        }

        .card::before, .card::after {
            position: absolute;
            font-size: 0.9rem;
        }

        .card::before { top: 5px; left: 5px; }
        .card::after { bottom: 5px; right: 5px; transform: rotate(180deg); }

        .card.suit-♥, .card.suit-♦ { color: red; }
        .card.suit-♣, .card.suit-♠ { color: black; }

        .game-info, .player-actions {
            margin: 1.5rem 0;
        }

        #message {
            min-height: 24px;
            font-size: 1.2rem;
            font-weight: bold;
            color: #ffdd57;
        }

        button {
            background-color: var(--button-bg);
            color: #000;
            border: none;
            padding: 0.8rem 1.5rem;
            font-size: 1rem;
            font-weight: bold;
            border-radius: 8px;
            cursor: pointer;
            margin: 5px;
            transition: background-color 0.2s;
            text-transform: uppercase;
        }

        button:hover:not(:disabled) {
            background-color: var(--button-hover-bg);
        }

        button:disabled {
            background-color: #777;
            cursor: not-allowed;
        }
    </style>
</head>
<body>

    <div class="game-container">
        <h1>Blackjack</h1>

        <div class="game-info">
            <h2>Рука Дилера (<span id="dealer-score">0</span>)</h2>
            <div id="dealer-hand" class="hand"></div>
        </div>

        <div class="game-info">
            <h2>Ваша Рука (<span id="player-score">0</span>)</h2>
            <div id="player-hand" class="hand"></div>
        </div>

        <p id="message">Нажмите "Новая игра", чтобы начать.</p>
        
        <div class="player-actions">
            <button id="hit-button">Еще</button>
            <button id="stand-button">Хватит</button>
            <button id="new-game-button">Новая игра</button>
        </div>
    </div>

    <script>
        // Игровой скрипт
        const suits = ['♥', '♦', '♣', '♠'];
        const values = ['2', '3', '4', '5', '6', '7', '8', '9', '10', 'J', 'Q', 'K', 'A'];

        let deck = [];
        let playerHand = [];
        let dealerHand = [];
        let playerScore = 0;
        let dealerScore = 0;
        let gameInProgress = false;

        // Получаем элементы DOM
        const dealerHandEl = document.getElementById('dealer-hand');
        const playerHandEl = document.getElementById('player-hand');
        const dealerScoreEl = document.getElementById('dealer-score');
        const playerScoreEl = document.getElementById('player-score');
        const messageEl = document.getElementById('message');
        const hitButton = document.getElementById('hit-button');
        const standButton = document.getElementById('stand-button');
        const newGameButton = document.getElementById('new-game-button');

        // Создание колоды
        function createDeck() {
            deck = [];
            for (let suit of suits) {
                for (let value of values) {
                    deck.push({ suit, value });
                }
            }
            return deck;
        }

        // Перетасовка колоды
        function shuffleDeck(deck) {
            for (let i = deck.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [deck[i], deck[j]] = [deck[j], deck[i]];
            }
        }

        // Вычисление очков в руке
        function getHandValue(hand) {
            let score = 0;
            let numAces = 0;
            for (let card of hand) {
                if (card.value === 'A') {
                    numAces++;
                    score += 11;
                } else if (['K', 'Q', 'J'].includes(card.value)) {
                    score += 10;
                } else {
                    score += parseInt(card.value);
                }
            }
            // Корректировка тузов, если счет > 21
            while (score > 21 && numAces > 0) {
                score -= 10;
                numAces--;
            }
            return score;
        }

        // Отображение карты
        function renderCard(card, element, isHidden = false) {
            const cardDiv = document.createElement('div');
            cardDiv.classList.add('card', `suit-${card.suit}`);
            if (isHidden) {
                cardDiv.classList.add('hidden');
            } else {
                cardDiv.textContent = card.value;
                cardDiv.setAttribute('data-value', `${card.value} ${card.suit}`);
                const before = document.createElement('span');
                before.textContent = card.suit;
                const after = document.createElement('span');
                after.textContent = card.suit;
                cardDiv.prepend(before);
                cardDiv.append(after);
            }
            element.appendChild(cardDiv);
        }
        
        // Обновление интерфейса
        function updateUI() {
            // Очищаем руки
            dealerHandEl.innerHTML = '';
            playerHandEl.innerHTML = '';

            // Отображаем карты дилера
            for (let i = 0; i < dealerHand.length; i++) {
                renderCard(dealerHand[i], dealerHandEl, i === 0 && gameInProgress);
            }

            // Отображаем карты игрока
            playerHand.forEach(card => renderCard(card, playerHandEl));
            
            // Обновляем счет
            playerScore = getHandValue(playerHand);
            dealerScore = getHandValue(dealerHand);
            
            playerScoreEl.textContent = playerScore;
            if (gameInProgress) {
                dealerScoreEl.textContent = getHandValue([dealerHand[1]]); // Показываем очки только второй карты дилера
            } else {
                dealerScoreEl.textContent = dealerScore;
            }

            // Проверка на Blackjack у игрока при старте
            if (playerScore === 21 && playerHand.length === 2) {
                endGame();
            }
        }

        // Начало новой игры
        function newGame() {
            gameInProgress = true;
            createDeck();
            shuffleDeck(deck);
            
            playerHand = [deck.pop(), deck.pop()];
            dealerHand = [deck.pop(), deck.pop()];
            
            messageEl.textContent = '';
            hitButton.disabled = false;
            standButton.disabled = false;
            
            updateUI();
        }

        // Действие "Еще" (Hit)
        function hit() {
            if (!gameInProgress) return;
            playerHand.push(deck.pop());
            updateUI();
            if (playerScore > 21) {
                messageEl.textContent = 'Перебор! Вы проиграли.';
                endGame();
            }
        }

        // Действие "Хватит" (Stand)
        function stand() {
            if (!gameInProgress) return;
            gameInProgress = false; // Игра переходит к дилеру

            // Показать скрытую карту дилера
            dealerHandEl.innerHTML = '';
            dealerHand.forEach(card => renderCard(card, dealerHandEl));
            dealerScoreEl.textContent = getHandValue(dealerHand);
            
            // Дилер берет карты до 17 очков
            while (getHandValue(dealerHand) < 17) {
                dealerHand.push(deck.pop());
                renderCard(dealerHand[dealerHand.length-1], dealerHandEl);
            }
            
            dealerScore = getHandValue(dealerHand);
            dealerScoreEl.textContent = dealerScore;
            
            determineWinner();
        }
        
        // Определение победителя
        function determineWinner() {
            playerScore = getHandValue(playerHand);
            dealerScore = getHandValue(dealerHand);

            if (playerScore > 21) {
                messageEl.textContent = 'Перебор! Вы проиграли.';
            } else if (dealerScore > 21) {
                messageEl.textContent = 'У дилера перебор! Вы выиграли!';
            } else if (playerScore > dealerScore) {
                messageEl.textContent = 'Вы выиграли!';
            } else if (dealerScore > playerScore) {
                messageEl.textContent = 'Вы проиграли.';
            } else {
                messageEl.textContent = 'Ничья.';
            }
            
            endGame(false);
        }

        // Завершение раунда
        function endGame(isImmediate = true) {
            if (isImmediate) {
                // Если игра завершается сразу (например, перебор у игрока)
                gameInProgress = false;
            }
            
            // Показываем скрытую карту дилера в конце
            dealerHandEl.innerHTML = '';
            dealerHand.forEach(card => renderCard(card, dealerHandEl));
            dealerScoreEl.textContent = getHandValue(dealerHand);

            hitButton.disabled = true;
            standButton.disabled = true;
        }

        // Навешиваем обработчики событий
        newGameButton.addEventListener('click', newGame);
        hitButton.addEventListener('click', hit);
        standButton.addEventListener('click', stand);

        // Инициализация кнопок при загрузке
        hitButton.disabled = true;
        standButton.disabled = true;
    </script>
</body>
</html>
